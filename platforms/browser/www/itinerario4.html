<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Bienvenido</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="css/normalize.css">
  <link rel="stylesheet" type="text/css" href="css/framework.css">
  <link rel="stylesheet" type="text/css" href="css/styles.css">
  <link rel="shortcut icon" type="image/x-icon" href="images/logo.ico">
  <link rel="apple-touch-icon" href="images/logo.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link href="css/ionicons.min.css" rel="stylesheet" type="text/css" />
</head>
<body style="background: #E3E3E3;">
  <section class="w-section mobile-wrapper" style="background: #E3E3E3;">
    <div class="page-content" id="main-stack">
      <div class="w-nav navbar" data-collapse="all" data-animation="over-left" data-duration="400" data-contain="1" data-easing="ease-out-quint" data-no-scroll="1">
        <div class="w-container">
          <nav class="w-nav-menu nav-menu bg-gradient-alt" role="navigation">
            <div class="nav-menu-header">
              <div class="logo">Menú</div>
            </div>
            <a class="w-clearfix w-inline-block nav-menu-link" href="home.html" data-load="1">
              <div class="icon-list-menu">
                <div class="icon ion-ios-home-outline"></div>
              </div>
              <div class="nav-menu-titles">Inicio</div>
            </a>
            <a class="w-clearfix w-inline-block nav-menu-link" href="itinerario.html" data-load="1">
              <div class="icon-list-menu">
                <div class="icon ion-ios-clock-outline"></div>
              </div>
              <div class="nav-menu-titles">Itinerario</div>
            </a>
            <a class="w-clearfix w-inline-block nav-menu-link" href="programa.html" data-load="1">
              <div class="icon-list-menu">
                <div class="icon ion-ios-calendar-outline"></div>
              </div>
              <div class="nav-menu-titles">Programa</div>
            </a>
            <a class="w-clearfix w-inline-block nav-menu-link" href="conferencistas.html" data-load="1">
              <div class="icon-list-menu">
                <div class="icon ion-ios-people"></div>
              </div>
              <div class="nav-menu-titles">Conferencistas</div>
            </a>
            <a class="w-clearfix w-inline-block nav-menu-link" href="auditorio.html" data-load="1">
              <div class="icon-list-menu">
                <div class="icon ion-location"></div>
              </div>
              <div class="nav-menu-titles">Auditorio</div>
            </a>
            <a class="w-clearfix w-inline-block nav-menu-link" href="transportacion.html" data-load="1">
              <div class="icon-list-menu">
                <div class="icon ion-android-bus"></div>
              </div>
              <div class="nav-menu-titles">Transportación</div>
            </a>
            <a class="w-clearfix w-inline-block nav-menu-link" id="logout" href="#" data-load="1">
              <div class="icon-list-menu">
                <div class="icon ion-log-out"></div>
              </div>
              <div class="nav-menu-titles">Salir</div>
            </a>
            <div class="separator-bottom"></div>
            <div class="separator-bottom"></div>
            <div class="separator-bottom"></div>
          </nav>
          <div class="wrapper-mask" data-ix="menu-mask"></div>
          <div class="navbar-title">Itinerario</div>
          <div class="w-nav-button navbar-button left" id="menu-button" data-ix="hide-navbar-icons">
            <div class="navbar-button-icon home-icon">
              <div class="bar-home-icon top"></div>
              <div class="bar-home-icon middle"></div>
              <div class="bar-home-icon bottom"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="body">
        <div class="home-content">

          <div>
            
            <div class="w-row ctn-cal">
                <div class="w-col w-col-1 w-col-small-1 w-col-tiny-1 n-p-r">
                  
                </div>
                <div class="w-col w-col-2 w-col-small-2 w-col-tiny-2 n-p-l" style="text-align: center;">
                  <a href="itinerario.html" data-load="1" class="c-white" style="display: inline-block;padding: 10px 0 10px 0;">
                    <strong>
                      Mar <br> 5
                    </strong>
                  </a>
                </div>
                <div class="w-col w-col-2 w-col-small-2 w-col-tiny-2" style="text-align: center;">
                  <a href="itinerario2.html" data-load="1" class="c-white" style="display: inline-block;padding: 10px 0 10px 0;">
                    <strong>
                      Mie <br> 6
                    </strong>
                  </a>
                </div>
                <div class="w-col w-col-2 w-col-small-2 w-col-tiny-2 n-p-r" style="text-align: center;">
                  <a href="itinerario3.html" class="c-white" style="display: inline-block;padding: 10px 0 10px 0;">
                    <strong>
                      Jue <br> 7
                    </strong>
                  </a>
                </div>
                <div class="w-col w-col-2 w-col-small-2 w-col-tiny-2 n-p-r" style="text-align: center;">
                  <a href="itinerario4.html" class="c-white active-cal" style="display: inline-block;padding: 10px 0 10px 0;">
                    <strong>
                      Vie <br> 8
                    </strong>
                  </a>
                </div>
                <div class="w-col w-col-2 w-col-small-2 w-col-tiny-2 n-p-r" style="text-align: center;">
                  <a href="itinerario5.html" class="c-white" style="display: inline-block;padding: 10px 0 10px 0;">
                    <strong>
                      Sab <br> 9
                    </strong>
                  </a>
                </div>
              </div>

              <ul class="list list-events" id="list-itinerario"></ul>              
            
          </div>          
      </div>

      <div style="margin-top: 25px;">
        <div class="w-row">
          <div class="w-col w-col-12 w-col-small-12 w-col-tiny-12 n-p-r" style="text-align: center;">
            <a href="programa.html" class="btn-black">
              AGREGAR MÁS <i class="icon ion-chevron-right" style="padding-left: 7px;"></i>
            </a>
          </div>
        </div>
      </div>

    </div>
    <div class="page-content loading-mask" id="new-stack">
      <div class="loading-icon">
        <div class="navbar-button-icon icon ion-load-d"></div>
      </div>
    </div>
  </section>
  <script src="js/webfont.js"></script>
  <script>
    WebFont.load({
      google: {
        families: ["Montserrat:400,700"]
      }
    });
  </script>
  <script type="text/javascript" src="js/modernizr.js"></script>
  <script type="text/javascript" src="js/jquery.min.js"></script>
  <script type="text/javascript" src="js/framework.js"></script>
  <script type="text/javascript" src="cordova.js"></script>
  <script type="text/javascript" src="js/scripts.js"></script>
  <!--[if lte IE 9]><script src="js/placeholders.min.js"></script><![endif]-->
  <script>
    $(document).on("ready", function(){

      var base_url = 'http://api.icem2018.com/api/v1';
      var assets_url = 'https://icem2018.com/';     
      var icem_customer = window.localStorage.getItem("icem_customer");                 

        var goToPage = function(hrefPage){
          document.location = hrefPage;
        };

        $(document).on("click",".actionSec", function(e){
          e.preventDefault();

          var id = $(this).data("id");

          var callback = function(buttonIndex) {
            setTimeout(function() {
            // like other Cordova plugins (prompt, confirm) the buttonIndex is 1-based (first button is index 1)                            

              if(buttonIndex == 1){             
                $.ajax({
                  type: 'DELETE',
                  url: base_url+'/users_schedules/'+id,                  
                  beforeSend: function(){
                    $('.loading-mask').addClass('stop-loading');
                  },  
                  error: function(xhr, status, error) {
                      var err = JSON.parse(xhr.responseText);
                      if(!err.success){                          
                          navigator.notification.alert(err.message, null, '', 'Cerrar');          
                      }
                  },
                  success: function(data) {
                    if(data.success){
                      location.reload();
                      navigator.notification.alert("Se eliminó de tu itinerario.", null, '', 'Cerrar');
                    }                    
                  }
                });
              }

            });
          };

          var options = {
              'androidTheme' : window.plugins.actionsheet.ANDROID_THEMES.THEME_DEVICE_DEFAULT_LIGHT,
              //'buttonLabels': ['Eliminar'],
              'addDestructiveButtonWithLabel': 'Eliminar',
              'androidEnableCancelButton' : true, // default false
              'winphoneEnableCancelButton' : true, // default false
              'addCancelButtonWithLabel': 'Cancelar'
          };
          window.plugins.actionsheet.show(options, callback);
        });

        $.ajax({
            type: 'GET',
            url: base_url+'/schedules_by_user/'+icem_customer+'/2018-06-08',     
            beforeSend: function(){
              $('.loading-mask').addClass('stop-loading');
            },  
            error: function(xhr, status, error) {
                var err = JSON.parse(xhr.responseText);
                if(!err.success){
                    alert(err.message);                    
                }
            },
            success: function(data) {
                if(data.success){
                  if(data.data.length){
                    $.each(data.data, function(index, value) {                    

                      if(value.schedule.location){
                        var location = value.schedule.location_txt.name;
                      }else{
                        var location = "";
                      }

                      if(value.schedule.duration_format){
                        var duration = value.schedule.duration_format;
                      }else{
                        var duration = "";
                      }

                      if(value.schedule.theme_txt){
                        var theme = value.schedule.theme_txt.name;
                      }else{
                        var theme = "";
                      }

                      if(value.schedule.speaker_txt){
                        var speaker = value.schedule.speaker_txt.name;
                      }else{
                        var speaker = "";
                      }

                      if(value.schedule.speaker2_txt){
                        var speaker2 = '                        <div style="clear: both;"><div class="left-text-icon icon ion-ios-person"></div>\n' +
                          '                        <div class="event-text">'+value.schedule.speaker2_txt.name+'</div></div>\n';
                      }else{
                        var speaker2 = "";
                      }

                      if(value.schedule.speaker3_txt){
                        var speaker3 = '                        <div style="clear: both;"><div class="left-text-icon icon ion-ios-person"></div>\n' +
                          '                        <div class="event-text">'+value.schedule.speaker3_txt.name+'</div></div>\n';
                      }else{
                        var speaker3 = "";
                      }

                      $("#list-itinerario").append('<li class="list-calendar-events" data-ix="list-item" style="opacity: 1; transform: translateX(0px) translateY(0px); transition: opacity 500ms cubic-bezier(0.23, 1, 0.32, 1), transform 500ms cubic-bezier(0.23, 1, 0.32, 1);">\n' +
                          '                  <a class="w-clearfix w-inline-block actionSec" href="" data-load="1" data-id="'+value.id+'">\n' +
                          '                    <div class="calendar-col-left" style="padding-right: 32px;">\n' +
                          '                      <div class="event-title">'+value.schedule.name+'</div>\n' +
                          '                      <div class="w-clearfix text-event-wrap">\n' +
                          '                        <div class="left-text-icon icon ion-ios-clock-outline"></div>\n' +
                          '                        <div class="event-text">'+duration+'hrs</div>\n' +
                          '                        <div class="left-text-icon icon ion-ios-location-outline"></div>\n' +
                          '                        <div class="event-text">'+location+'</div>\n' +
                          '                        <div style="clear: both;"><div class="left-text-icon icon ion-document-text"></div>\n' +
                          '                        <div class="event-text">'+theme+'</div></div>\n' +
                          '                        <div style="clear: both;"><div class="left-text-icon icon ion-ios-person"></div>\n' +
                          '                        <div class="event-text">'+speaker+'</div></div>\n' + speaker2 + speaker3 +
                          '                      </div>\n' +
                          '                    </div>\n' +
                          '                    <div class="w-clearfix calendar-col-right">\n' +
                          '                      <div class="icon ion-more" style="font-size: 22px;"></div>\n' +
                          '                    </div>\n' +
                          '                  </a>\n' +
                          '                </li>');
                    });
                  }else{
                    $("#list-itinerario").html('<li class="list-calendar-events" data-ix="list-item" style="opacity: 1; transform: translateX(0px) translateY(0px); transition: opacity 500ms cubic-bezier(0.23, 1, 0.32, 1), transform 500ms cubic-bezier(0.23, 1, 0.32, 1);text-align: center;"><h3>Aún no has agregado nada a tu itinerario</h3> <br> <br> Visita el programa para comenzar a agregar las conferencias o talleres de tu interés.<li>');
                  }                  
                }
            },
        });
      
    }); 
  </script>
</body>
</html>